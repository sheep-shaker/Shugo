# ============================================
# SHUGO v7.0 - Configuration PRODUCTION
# ============================================
#
# IMPORTANT: Ce fichier sert de template uniquement.
# Ne jamais commiter le fichier .env de production !
#
# Checklist de sécurité:
# [ ] Tous les secrets sont générés de manière aléatoire
# [ ] SSL est activé pour la base de données
# [ ] Redis est configuré avec mot de passe
# [ ] Les domaines CORS sont correctement définis
# [ ] Le 2FA est obligatoire pour les admins
#
# ============================================

# === ENVIRONNEMENT ===
NODE_ENV=production

# === SERVEUR ===
PORT=3000
HOST=0.0.0.0
SERVER_ID=central-prod-001
SERVER_TYPE=central
BASE_URL=https://api.votre-domaine.com
TRUST_PROXY=true

# === BASE DE DONNÉES PostgreSQL ===
# OBLIGATOIRE en production
DB_DIALECT=postgres
DB_HOST=postgres.votre-domaine.com
DB_PORT=5432
DB_NAME=shugo_production
DB_USER=shugo_prod
DB_PASSWORD=<GÉNÉRER_MOT_DE_PASSE_FORT_32_CHARS>
DB_LOGGING=false
DB_TIMEZONE=+00:00

# SSL OBLIGATOIRE en production
DB_SSL=true
DB_SSL_REJECT_UNAUTHORIZED=true

# Pool de connexions (ajuster selon la charge)
DB_POOL_MAX=50
DB_POOL_MIN=10
DB_POOL_ACQUIRE=60000
DB_POOL_IDLE=10000

# === REDIS (OBLIGATOIRE en production) ===
REDIS_ENABLED=true
REDIS_HOST=redis.votre-domaine.com
REDIS_PORT=6379
REDIS_PASSWORD=<GÉNÉRER_MOT_DE_PASSE_REDIS>
REDIS_DB=0
REDIS_PREFIX=shugo:prod:

# === JWT ET AUTHENTIFICATION ===
# CRITIQUE: Générer avec: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
JWT_SECRET=<GÉNÉRER_128_CARACTÈRES_HEX>
JWT_REFRESH_SECRET=<GÉNÉRER_128_CARACTÈRES_HEX_DIFFÉRENT>
JWT_ACCESS_EXPIRES=15m
JWT_REFRESH_EXPIRES=7d
JWT_ISSUER=shugo-central
JWT_AUDIENCE=shugo-users

# === SÉCURITÉ ET CRYPTOGRAPHIE ===
# CRITIQUE: Générer avec: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
ENCRYPTION_KEY=<GÉNÉRER_64_CARACTÈRES_HEX>
HMAC_KEY=<GÉNÉRER_64_CARACTÈRES_HEX>
VAULT_MASTER_KEY=<GÉNÉRER_64_CARACTÈRES_HEX>
COOKIE_SECRET=<GÉNÉRER_MOT_DE_PASSE_FORT>

# Argon2 (production - valeurs plus élevées)
ARGON2_MEMORY=131072
ARGON2_TIME=4
ARGON2_PARALLELISM=4

# Rate limiting (plus strict en production)
RATE_LIMIT_WINDOW=900000
RATE_LIMIT_MAX=100
RATE_LIMIT_AUTH=3
AUTH_LOCKOUT_MINUTES=30

# Sessions
MAX_CONCURRENT_SESSIONS=3
SESSION_INACTIVITY=1800000

# === GÉOGRAPHIE ===
DEFAULT_GEO_ID=02-33-06-01-00
DEFAULT_TIMEZONE=Europe/Paris
DEFAULT_LANGUAGE=fr

# === NOTIFICATIONS - Mailjet (OBLIGATOIRE en production) ===
MAILJET_ENABLED=true
MAILJET_API_KEY=<VOTRE_CLÉ_API_MAILJET>
MAILJET_API_SECRET=<VOTRE_SECRET_MAILJET>
MAILJET_FROM_EMAIL=noreply@votre-domaine.com
MAILJET_FROM_NAME=SHUGO

# === MAINTENANCE ===
MAINTENANCE_ENABLED=true
MAINTENANCE_HOUR=3
MAINTENANCE_MINUTE=0
MAINTENANCE_DURATION=30
MAINTENANCE_TIMEZONE=Europe/Paris

# === SAUVEGARDE ===
BACKUP_ENABLED=true
BACKUP_DAILY_HOUR=1
BACKUP_DAILY_MINUTE=0
BACKUP_WEEKLY_DAY=0
BACKUP_WEEKLY_HOUR=2
BACKUP_PATH=/data/backups

# Rétention
BACKUP_RETENTION_DAILY=30
BACKUP_RETENTION_WEEKLY=90
BACKUP_RETENTION_MONTHLY=365

# Stockage externe (S3 recommandé)
BACKUP_EXTERNAL_ENABLED=true
BACKUP_EXTERNAL_TYPE=s3
BACKUP_EXTERNAL_BUCKET=shugo-backups-prod
BACKUP_EXTERNAL_REGION=eu-west-3

# === LOGS ===
LOG_LEVEL=info
LOG_FORMAT=json
LOG_DIR=/data/logs
LOG_MAX_SIZE=50m
LOG_MAX_FILES=30d
AUDIT_RETENTION_DAYS=730

# === PLUGINS ===
PLUGINS_ENABLED=true
PLUGINS_DIR=/data/plugins
PLUGINS_AUTOLOAD=false

# === CORS ===
CORS_ENABLED=true
CORS_ORIGINS=https://votre-domaine.com,https://app.votre-domaine.com

# === FEATURES FLAGS ===
FEATURE_2FA_REQUIRED=true
FEATURE_EMAIL_VERIFY=true
FEATURE_REGISTRATION_OPEN=false
FEATURE_MAINTENANCE_MODE=false
FEATURE_DEBUG_MODE=false

# === SWAGGER (désactivé par défaut en prod) ===
ENABLE_SWAGGER=false

# ============================================
# INSTRUCTIONS DE GÉNÉRATION DES SECRETS
# ============================================
#
# JWT_SECRET et JWT_REFRESH_SECRET (128 chars):
# node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
#
# ENCRYPTION_KEY, HMAC_KEY, VAULT_MASTER_KEY (64 chars):
# node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
#
# Mots de passe génériques:
# openssl rand -base64 32
#
# ============================================
