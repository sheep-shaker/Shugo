# ============================================
# SHUGO v7.0 - Configuration Environnement
# ============================================
# Copiez ce fichier en .env et modifiez les valeurs
# IMPORTANT: Ne jamais commiter le fichier .env !
# ============================================

# === ENVIRONNEMENT ===
NODE_ENV=development
# Options: development, test, production

# === SERVEUR ===
PORT=3000
HOST=0.0.0.0
SERVER_ID=central-001
SERVER_TYPE=central
# central ou local
BASE_URL=http://localhost:3000

# === BASE DE DONNÉES PostgreSQL ===
DB_HOST=localhost
DB_PORT=5432
DB_NAME=shugo_central
DB_USER=shugo
DB_PASSWORD=CHANGE_ME_IN_PRODUCTION
DB_LOGGING=false
# true pour voir les requêtes SQL
DB_TIMEZONE=+00:00
DB_SSL=false
# true en production avec certificat
DB_SSL_REJECT_UNAUTHORIZED=true

# Pool de connexions
DB_POOL_MAX=20
DB_POOL_MIN=5
DB_POOL_ACQUIRE=30000
DB_POOL_IDLE=10000

# Réplication (optionnel)
# DB_REPLICA_HOST=
# DB_REPLICA_USER=
# DB_REPLICA_PASSWORD=

# === REDIS (Cache et sessions) ===
REDIS_ENABLED=false
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_PREFIX=shugo:

# === JWT ET AUTHENTIFICATION ===
# IMPORTANT: Générer des secrets forts en production !
# Utiliser: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
JWT_SECRET=CHANGE_ME_64_CHARS_MINIMUM_IN_PRODUCTION_USE_CRYPTO_RANDOM_BYTES
JWT_REFRESH_SECRET=CHANGE_ME_ANOTHER_64_CHARS_MINIMUM_DIFFERENT_FROM_JWT_SECRET
JWT_ACCESS_EXPIRES=15m
JWT_REFRESH_EXPIRES=7d
JWT_ISSUER=shugo-central
JWT_AUDIENCE=shugo-users

# === SÉCURITÉ ET CRYPTOGRAPHIE ===
# Clé AES-256 (64 caractères hex = 32 bytes)
# Générer: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
ENCRYPTION_KEY=0000000000000000000000000000000000000000000000000000000000000000

# Clé HMAC (64 caractères hex)
HMAC_KEY=0000000000000000000000000000000000000000000000000000000000000000

# Clé maître du Vault (64 caractères hex)
VAULT_MASTER_KEY=0000000000000000000000000000000000000000000000000000000000000000

# Cookie secret
COOKIE_SECRET=CHANGE_ME_COOKIE_SECRET_STRONG

# Argon2 (hachage mot de passe)
ARGON2_MEMORY=65536
# Mémoire en Ko (64 Mo par défaut)
ARGON2_TIME=3
# Nombre d'itérations
ARGON2_PARALLELISM=4
# Threads parallèles

# TOTP (2FA)
TOTP_ISSUER=SHUGO
TOTP_WINDOW=1
# Fenêtre de validation (±1 par défaut)

# Rate limiting
RATE_LIMIT_WINDOW=900000
# 15 minutes en ms
RATE_LIMIT_MAX=100
# Requêtes max par fenêtre
RATE_LIMIT_AUTH=5
# Tentatives auth max
AUTH_LOCKOUT_MINUTES=15
# Durée blocage après échecs

# Sessions
MAX_CONCURRENT_SESSIONS=5
SESSION_INACTIVITY=1800000
# 30 minutes en ms

# === GÉOGRAPHIE ===
DEFAULT_GEO_ID=02-33-06-01-00
# Format: CC-PPP-ZZ-JJ-NN
DEFAULT_TIMEZONE=Europe/Paris
DEFAULT_LANGUAGE=fr
# fr, en, it, es, pt

# === NOTIFICATIONS - Mailjet ===
MAILJET_ENABLED=false
MAILJET_API_KEY=
MAILJET_API_SECRET=
MAILJET_FROM_EMAIL=noreply@shugo.app
MAILJET_FROM_NAME=SHUGO

# === NOTIFICATIONS - Matrix/Element ===
MATRIX_ENABLED=false
MATRIX_HOMESERVER=https://matrix.org
MATRIX_ACCESS_TOKEN=
MATRIX_USER_ID=@shugo-bot:matrix.org

# === MAINTENANCE ===
MAINTENANCE_ENABLED=true
MAINTENANCE_HOUR=0
# Heure de maintenance (0-23)
MAINTENANCE_MINUTE=0
MAINTENANCE_DURATION=45
# Durée en minutes
MAINTENANCE_TIMEZONE=local
# local ou UTC

# === SAUVEGARDE ===
BACKUP_ENABLED=true
BACKUP_DAILY_HOUR=0
BACKUP_DAILY_MINUTE=30
BACKUP_WEEKLY_DAY=0
# 0 = Dimanche
BACKUP_WEEKLY_HOUR=2
BACKUP_PATH=./backups

# Rétention (jours)
BACKUP_RETENTION_DAILY=30
BACKUP_RETENTION_WEEKLY=90
BACKUP_RETENTION_MONTHLY=365

# Stockage externe (optionnel)
BACKUP_EXTERNAL_ENABLED=false
BACKUP_EXTERNAL_TYPE=s3
# s3, gcs, azure
BACKUP_EXTERNAL_BUCKET=
BACKUP_EXTERNAL_REGION=

# === LOGS ===
LOG_LEVEL=info
# debug, info, warn, error
LOG_FORMAT=json
# json ou simple
LOG_DIR=./logs
LOG_MAX_SIZE=20m
LOG_MAX_FILES=14d
AUDIT_RETENTION_DAYS=365

# === PLUGINS ===
PLUGINS_ENABLED=true
PLUGINS_DIR=./plugins
PLUGINS_AUTOLOAD=false

# === CORS ===
CORS_ENABLED=true
CORS_ORIGINS=http://localhost:3000,http://localhost:8080
# Séparés par virgule

# === FEATURES FLAGS ===
FEATURE_2FA_REQUIRED=false
# true pour forcer 2FA
FEATURE_EMAIL_VERIFY=true
# Vérification email obligatoire
FEATURE_REGISTRATION_OPEN=true
# Inscription ouverte
FEATURE_MAINTENANCE_MODE=false
# Mode maintenance global
FEATURE_DEBUG_MODE=false
# Informations debug supplémentaires

# === TESTS (optionnel) ===
TEST_DB_HOST=localhost
TEST_DB_PORT=5432
TEST_DB_NAME=shugo_test
TEST_DB_USER=shugo_test
TEST_DB_PASSWORD=test_password

# ============================================
# NOTES DE SÉCURITÉ POUR LA PRODUCTION
# ============================================
# 
# 1. Générer tous les secrets avec:
#    node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
#
# 2. Utiliser des mots de passe forts pour PostgreSQL
#
# 3. Activer SSL pour la base de données
#
# 4. Configurer HTTPS via reverse proxy (nginx/traefik)
#
# 5. Activer Redis pour la production
#
# 6. Configurer les backups externes
#
# 7. Ne jamais exposer ce fichier publiquement
#
# ============================================
